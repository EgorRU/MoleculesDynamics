# MoleculesDynamics

**MoleculesDynamics** — это приложение на основе Qt для моделирования молекулярной динамики с 3D-визуализацией. Поддерживает шесть численных методов интегрирования и предоставляет сравнение точности с помощью среднеквадратичного отклонения (MSE). Симуляция моделирует поведение молекул, взаимодействующих через потенциал Леннарда-Джонса, с отражающими граничными условиями.

## Возможности

- **Шесть численных методов интегрирования:**
  - Метод Рунге-Кутта 4-го порядка
  - Метод Верле
  - Скоростной метод Верле
  - Метод с перескоками (Leapfrog)
  - Метод Бимана-Шофилда
  - Метод предиктор-корректор

- **Визуализация:**
  - Шесть интерактивных 3D-графиков (по одному на каждый метод) с использованием `Q3DScatter`
  - Отображение положений молекул в реальном времени
  - Обновление подписей и значений MSE на каждом шаге симуляции

- **Настраиваемые параметры:**
  - **Количество молекул (N):** 2 – 1000
  - **Плотность (ρ):** 0.1 – 15
  - **Масса:** 0.1 – 1000
  - **Параметры потенциала Леннарда-Джонса:**
    - **ε (глубина потенциальной ямы):** 0.1 – 100
    - **σ (радиус взаимодействия):** 0.1 – 100
  - **Дисперсия нач. скоростей:** 0.1 – 30
  - **Шаг по времени (dt):** 0.000001 – 0.001
  - **Количество шагов симуляции:** 100 – 100,000

- **Расчет и отображение MSE:**
  - Выбор эталонного метода для сравнения через выпадающий список (`QComboBox`)
  - Расчет MSE на каждом шаге с усреднением по ходу симуляции
  - Отображение MSE для каждого метода в реальном времени

- **Дополнительные функции:**
  - Отражающие граничные условия для удержания молекул в кубической области
  - Пауза и возобновление симуляции
  - Пошаговое выполнение симуляции при паузе
  - Сброс вида камер для всех 3D-графиков
  - Генерация новых начальных условий или перезапуск с текущими
  - Отображение текущего шага и общего количества шагов

## Интерфейс

### Основной макет:
- **Левая панель:** Шесть 3D-графиков, расположенных в сетке 2x3, каждый с подписью, соответствующей методу.
- **Правая панель (управление):**
  - **Статус симуляции:** Показывает текущий шаг и общее количество шагов.
  - **Поля ввода параметров:** Виджеты `QDoubleSpinBox` для настройки параметров симуляции, каждый с:
    - **Подписью**, описывающей параметр
    - **Индикатором действия:**
      - **Генерация+перезапуск:** Создает новые начальные условия и перезапускает симуляцию
      - **Перезапуск:** Перезапускает симуляцию с текущими условиями
      - **Без действия:** Изменение параметра не влияет на симуляцию
  - **Выбор эталонного метода для MSE:** Выпадающий список для выбора метода сравнения
  - **Отображение MSE:** Подписи с текущими значениями MSE для каждого метода
  - **Кнопки управления:**
    - **Сгенерировать новые начальные условия:** Сбрасывает симуляцию с новыми случайными позициями и скоростями
    - **Начать моделирование заново на старых начальных условиях:** Перезапускает симуляцию без изменения начальных условий
    - **Пауза/Продолжить:** Переключает анимацию симуляции
    - **Следующий шаг:** Выполняет один шаг симуляции (активно при паузе)
    - **Сброс камер для графиков:** Возвращает камеры 3D-графиков в исходное положение

## Технические детали

- **Фреймворк:** Разработано с использованием Qt, визуализация реализована через `Q3DScatter`
- **Физическая модель:** Молекулы взаимодействуют через потенциал Леннарда-Джонса, силы рассчитываются в функции `computeLJForces`
- **Граничные условия:** Отражающие границы удерживают молекулы в кубической области, размер которой определяется плотностью и числом молекул
- **Начальные условия:**
  - Позиции: Случайно распределены внутри области симуляции
  - Скорости: Следуют нормальному распределению с нулевым средним импульсом
- **Численные методы:** Реализованы в `mathFunc.hpp` с подробными формулами для каждого метода интегрирования
- **Расчет MSE:** Вычисляется как среднеквадратичное расстояние между позициями молекул для данного метода и эталонного метода
- **Оптимизация производительности:** Используется `QTimer` с интервалом 10 мс для плавного обновления анимации

## Использование

1. **Настройка параметров:** Измените количество молекул, плотность, массу, параметры Леннарда-Джонса, диапазон начальных скоростей, шаг по времени и общее количество шагов с помощью полей ввода.
2. **Выбор эталонного метода:** Укажите метод для сравнения MSE через выпадающий список.
3. **Запуск симуляции:** Нажмите «Сгенерировать новые начальные условия» для создания новой симуляции или «Начать моделирование заново» для перезапуска с текущими условиями.
4. **Управление симуляцией:** Используйте кнопки «Пауза/Продолжить» и «Следующий шаг» для контроля выполнения.
5. **Анализ результатов:** Отслеживайте MSE для каждого метода и наблюдайте за движением молекул на 3D-графиках.
6. **Сброс камер:** Используйте кнопку «Сброс камер для графиков» для возврата к исходному виду графиков.